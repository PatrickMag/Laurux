' Gambas class file

Public Enum L_sans, L_valide, L_ajou, L_modif, L_sup
Public Enum Autre, Treso, Vente, caisse

Public Struct TableLettrage
  compte As String
  dte As LDate
  numlot As String
  numdoc As String
  montantd As Float
  montantc As Float
  lind As Integer
End Struct

Public numero As String
Public lind As Integer
Public dte As LDate
Public dtee As LDate
Public dteech As LDate
Public journal As String
Public compte As String
Public intitul As String
Public libelle As String
Public numdoc As String
Public numlot As String
Public montantd As Float
Public montantc As Float
Public type As Integer
Public etat As Integer
Public collectif As Boolean

Public Tlettrage As New TableLettrage[]

Public Tbl As New TableLettrage

Private $Vecr As New VarEcr[]

  Public Sub _next() As VarEcr

  If Enum.Index = Null Then Enum.Index = -1
  Enum.Index += 1
  If $Vecr.Count = Enum.Index Then 
    Enum.Stop
  Else
    Return $Vecr[Enum.Index]
  Endif

End

Public Sub _new()

End

Public Sub newTbl()

  Tbl = New TableLettrage

End

Public Sub plus(value As VarEcr)

  $Vecr.Add(value)

End

Public Function moins(Value As Variant) As Boolean

  Dim ind As Integer
  
  If TypeOf(value) = gb.Integer Then
    ind = value
  Else
    ind = $Vecr.Find(value)
  Endif
  If ind > -1 Then
    $Vecr.Extract(ind, 1)
    Return True
  Else
    Return False
  Endif

End

Public Function trouve(value As Variant) As Variant
  
  If TypeOf(value) = gb.Integer Then
    If value < $Vecr.Count Then Return $Vecr[value] Else Return -1
  Else
    Return $Vecr.Find(value)
  Endif
  
End

Public Function modifi(ind As Integer, value As VarEcr) As Boolean
  
  If ind < $Vecr.Count Then
    $Vecr[ind] = value
    Return True
  Else
    Return False
  Endif
  
End

Public Function somme() As Float
  
  Dim i As Integer
  Dim tot As Float
  
  For i = 0 To $Vecr.Max
    If Not $Vecr[i].collectif Then tot += Utils.arrondi($Vecr[i].montantd - $Vecr[i].montantc, 2)
  Next
  Return tot
  
End

Public Function nb() As Integer
  
  Return $Vecr.Count
  
End
